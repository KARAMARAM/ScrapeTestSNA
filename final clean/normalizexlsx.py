import pandas as pd
import re

# Load the dataset
df = pd.read_excel('unique_entities_normalized_fixed.xlsx')

print(f"Loaded dataset with {len(df):,} rows")
print(f"Unique entities before normalization: {df['Entity'].nunique():,}")

# Define comprehensive mapping dictionary for case-insensitive matching
entity_mapping = {
    # Putin variants
    'владимир владимирович': 'Владимир Путин',
    'владимир путин': 'Владимир Путин',
    
    # Security Council variants
    'совета национальной безопасности': 'Совет национальной безопасности (СНБ)',
    'совета безопасности': 'Совет национальной безопасности (СНБ)',
    'совбеза': 'Совет национальной безопасности (СНБ)',
    
    # Eurasia Drilling variants
    'eurasia drilling company edc': 'Eurasia Drilling Company (EDC)',
    'eurasia drilling': 'Eurasia Drilling Company (EDC)',
    
    # Chamber of Commerce variants
    'комитета тпп': 'Торгово-промышленная палата (ТПП)',
    'тпп': 'Торгово-промышленная палата (ТПП)',
    'торгово-промышленной палаты': 'Торгово-промышленная палата (ТПП)',
    
    # RDIF variants
    'управляющая компания российского фонда прямых инвестиций': 'Российский фонд прямых инвестиций (РФПИ)',
    'фонд прямых инвестиций': 'Российский фонд прямых инвестиций (РФПИ)',
    'рфпи': 'Российский фонд прямых инвестиций (РФПИ)',
    'ооо управляющая компания рфпи': 'Российский фонд прямых инвестиций (РФПИ)',
    'рфпи /обновлено': 'Российский фонд прямых инвестиций (РФПИ)',
    'ао ук рфпи': 'Российский фонд прямых инвестиций (РФПИ)',
    'ук рфпи': 'Российский фонд прямых инвестиций (РФПИ)',
    'рфпи с-петербург': 'Российский фонд прямых инвестиций (РФПИ)',
    'рпфи': 'Российский фонд прямых инвестиций (РФПИ)',
    
    # Eurasian Economic Commission variants
    'еэк': 'Евразийская экономическая комиссия (ЕЭК)',
    'евразийской экономической комиссии': 'Евразийская экономическая комиссия (ЕЭК)',
    
    # Ernst & Young variants
    'эрнст энд янг': 'Ernst & Young',
    'ernst&young': 'Ernst & Young',
    'ernst & young': 'Ernst & Young',
    
    # ALROSA variants
    'ак алроса': 'АК АЛРОСА',
    'алроса': 'АК АЛРОСА',
    'алросы': 'АК АЛРОСА',
    
    # Sergey Ryabkov variants
    'сергей рябков': 'Сергей Рябков',
    'рябков': 'Сергей Рябков',
    
    # Armed Forces variants
    'вооруженными силами': 'Вооруженные силы',
    'вооруженных сил': 'Вооруженные силы',
    
    # Moscow Exchange variants
    'московская биржа': 'Московская биржа',
    'мосбиржи': 'Московская биржа',
    'московскую биржу': 'Московская биржа',
    'московской биржи': 'Московская биржа',
    'ммвб-ртс': 'Московская биржа',
    'ммвб': 'Московская биржа',
    'ртс': 'Московская биржа',
    
    # EBRD variants
    'европейский банк реконструкции и развития ебрр': 'Европейский банк реконструкции и развития (ЕБРР)',
    'ебрр': 'Европейский банк реконструкции и развития (ЕБРР)',
    
    # Stock Exchange variants
    'лондонской фондовой бирже': 'Лондонская фондовая биржа',
    'лондонской бирже': 'Лондонская фондовая биржа',
    'нью-йоркской фондовой бирже': 'Лондонская фондовая биржа',
    
    # APEC variants
    'азиатско-тихоокеанского экономического сотрудничества атэс': 'Азиатско-Тихоокеанское экономическое сотрудничество (АТЭС)',
    'атэс': 'Азиатско-Тихоокеанское экономическое сотрудничество (АТЭС)',
    
    # HSE variants
    'вшэ': 'Высшая школа экономики (ВШЭ)',
    'ниу вшэ': 'Высшая школа экономики (ВШЭ)',
    'высшей школы экономики': 'Высшая школа экономики (ВШЭ)',
    
    # EMA variants
    'европейским агентством по лекарственным средствам ема': 'Европейское агентство по лекарственным средствам (ЕМА)',
    'ема': 'Европейское агентство по лекарственным средствам (ЕМА)',
    
    # Angela Merkel variants
    'ангела меркель': 'Ангела Меркель',
    'меркель': 'Ангела Меркель',
    
    # Renaissance Capital variants
    'ренессанс капитала': 'Ренессанс Капитал',
    'ренессанс': 'Ренессанс Капитал',
    
    # WHO variants
    'воз': 'Всемирная организация здравоохранения (ВОЗ)',
    'всемирной организации здравоохранения воз': 'Всемирная организация здравоохранения (ВОЗ)',
    'всемирная организация здравоохранения': 'Всемирная организация здравоохранения (ВОЗ)',
    
    # Steven Witkoff variants
    'уиткоффа': 'Стивен Уиткофф',
    'стивен уиткофф': 'Стивен Уиткофф',
    'спецпосланник трампа': 'Стивен Уиткофф',
    'стивом уиткоффом': 'Стивен Уиткофф',
    'уиткоффом': 'Стивен Уиткофф',
    
    # Gamaleya Center variants
    'центра имени гамалеи': 'Национальный исследовательский центр эпидемиологии и микробиологии имени Н.Ф. Гамалеи (НИЦЭМ)',
    'национальным исследовательским центром эпидемиологии и микробиологии имени н ф гамалеи': 'Национальный исследовательский центр эпидемиологии и микробиологии имени Н.Ф. Гамалеи (НИЦЭМ)',
    'ницэм имени гамалеи': 'Национальный исследовательский центр эпидемиологии и микробиологии имени Н.Ф. Гамалеи (НИЦЭМ)',
    'ниц гамалеи': 'Национальный исследовательский центр эпидемиологии и микробиологии имени Н.Ф. Гамалеи (НИЦЭМ)',
    'института имени гамалеи': 'Национальный исследовательский центр эпидемиологии и микробиологии имени Н.Ф. Гамалеи (НИЦЭМ)',
    'гамалеи': 'Национальный исследовательский центр эпидемиологии и микробиологии имени Н.Ф. Гамалеи (НИЦЭМ)',
    'ницэм им нф гамалеи': 'Национальный исследовательский центр эпидемиологии и микробиологии имени Н.Ф. Гамалеи (НИЦЭМ)',
    'ницэм': 'Национальный исследовательский центр эпидемиологии и микробиологии имени Н.Ф. Гамалеи (НИЦЭМ)',
    'ниц эпидемиологии и микробиологии имени гамалеи': 'Национальный исследовательский центр эпидемиологии и микробиологии имени Н.Ф. Гамалеи (НИЦЭМ)',
    'институт гамалеи': 'Национальный исследовательский центр эпидемиологии и микробиологии имени Н.Ф. Гамалеи (НИЦЭМ)',
    
    # Emmanuel Macron variants
    'эммануэль макрон': 'Эммануэль Макрон',
    'макрон': 'Эммануэль Макрон',
    
    # Anton Siluanov variants
    'антон силуанов': 'Антон Силуанов',
    'силуанов': 'Антон Силуанов',
    
    # National Wealth Fund variants
    'фнб': 'Фонд национального благосостояния (ФНБ)',
    'фонда национального благосостояния': 'Фонд национального благосостояния (ФНБ)',
    
    # Investigative Committee variants
    'россии скр': 'Следственный комитет России (СКР)',
    'скр': 'Следственный комитет России (СКР)',
    'следственным комитетом': 'Следственный комитет России (СКР)',
    'следственного комитета': 'Следственный комитет России (СКР)',
    
    # MegaFon variants
    'оао «мегафон»': 'ОАО «МегаФон»',
    'мегафон': 'ОАО «МегаФон»',
    'мегафона': 'ОАО «МегаФон»',
    
    # Vyacheslav Volodin variants
    'вячеслав': 'Вячеслав Володин',
    'вячеслав володин': 'Вячеслав Володин',
    
    # General Staff variants
    'генштаба': 'Генеральный штаб',
    'генерального штаба': 'Генеральный штаб',
    
    # Zelensky variants
    'зеленский': 'Владимир Зеленский',
    'владимир зеленский': 'Владимир Зеленский',
    'зеленского': 'Владимир Зеленский',
    'владимира зеленского': 'Владимир Зеленский',
    'зеленскому': 'Владимир Зеленский',
    
    # Marco Rubio variants
    'рубио': 'Марко Рубио',
    'марко рубио': 'Марко Рубио',
    
    # Boris Titov variants
    'борис титов': 'Борис Титов',
    'титов': 'Борис Титов',
    
    # Detsky Mir variants
    'детский мир': 'Детский мир',
    'детском мире': 'Детский мир',
    'детского мира': 'Детский мир',
    
    # State Hermitage variants
    'государственный эрмитаж': 'Государственный Эрмитаж',
    'эрмитажа': 'Государственный Эрмитаж',
    
    # Russian Academy of Sciences variants
    'российской академии наук': 'Российская академия наук (РАН)',
    'ран': 'Российская академия наук (РАН)',
    
    # Egor Borisov variants
    'егор борисов': 'Егор Борисов',
    'егор': 'Егор Борисов',
    
    # Sergey Sobyanin variants
    'сергей собянин': 'Сергей Собянин',
    'собянин': 'Сергей Собянин',
    
    # Joe Biden variants
    'байдена': 'Джо Байден',
    'джо байдена': 'Джо Байден',
    
    # VEB variants
    'вэб': 'Внешэкономбанк (ВЭБ)',
    'внешэкономбанка': 'Внешэкономбанк (ВЭБ)',
    'внешэкономбанк вэб': 'Внешэкономбанк (ВЭБ)',
    'вэбом': 'Внешэкономбанк (ВЭБ)',
    
    # Central Bank variants
    'центральный банк': 'Центральный банк',
    'центрального банка': 'Центральный банк',
    'центробанка': 'Центральный банк',
    
    # Transneft variants
    'пао транснефть': 'ПАО «Транснефть»',
    'транснефти': 'ПАО «Транснефть»',
    
    # Petro Poroshenko variants
    'петра порошенко': 'Петр Порошенко',
    'порошенко': 'Петр Порошенко',
    
    # Accounts Chamber variants
    'счетная палата': 'Счетная палата',
    'счетной палаты': 'Счетная палата',
    
    # FAS variants
    'федеральной антимонопольной службы': 'Федеральная антимонопольная служба (ФАС)',
    'федеральную антимонопольную службу фас': 'Федеральная антимонопольная служба (ФАС)',
    'фас': 'Федеральная антимонопольная служба (ФАС)',
    
    # RCIF variants
    'ркиф': 'Российско-китайский инвестиционный фонд (РКИФ)',
    'российско-китайский инвестиционный фонд ркиф': 'Российско-китайский инвестиционный фонд (РКИФ)',
    'российско-китайского инвестиционного фонда': 'Российско-китайский инвестиционный фонд (РКИФ)',
    'российско-китайский инвестфонд': 'Российско-китайский инвестиционный фонд (РКИФ)',
    'российско-китайский фонд': 'Российско-китайский инвестиционный фонд (РКИФ)',
    
    # Mikhail Murashko variants
    'михаил мурашко': 'Михаил Мурашко',
    'мурашко': 'Михаил Мурашко',
    
    # Federation Council variants
    'совета федерации': 'Совет Федерации',
    'госсовета': 'Совет Федерации',
    'совфеда': 'Совет Федерации',
    'государственного совета': 'Совет Федерации',
    
    # FC Otkritie variants
    'открытие': 'ФК «Открытие»',
    'фк открытие': 'ФК «Открытие»',
    
    # Alexander Novak variants
    'александр новак': 'Александр Новак',
    'новак': 'Александр Новак',
    
    # Human Rights Council variants
    'спч': 'Совет по правам человека (СПЧ)',
    'совет по правам человека': 'Совет по правам человека (СПЧ)',
    
    # Business Council variants
    'деловом совете': 'Деловой совет',
    'делового совета': 'Деловой совет',
    'делового консультативного совета': 'Деловой совет',
    
    # UN General Assembly variants
    'генеральной ассамблеи': 'Генеральная Ассамблея ООН',
    'оон': 'Генеральная Ассамблея ООН',
    'генассамблеи': 'Генеральная Ассамблея ООН',
    
    # Rostelecom variants
    'ростелеком': 'ОАО «Ростелеком»',
    'оао «ростелеком»': 'ОАО «Ростелеком»',
    'оао ростелеком': 'ОАО «Ростелеком»',
    
    # Arkady Dvorkovich variants
    'аркадий дворкович': 'Аркадий Дворкович',
    'дворкович': 'Аркадий Дворкович',
    
    # China Investment Corporation variants
    'китайская инвестиционная корпорация': 'China Investment Corporation',
    'китайской инвестиционной корпорацией': 'China Investment Corporation',
    'china investment corporation': 'China Investment Corporation',
    
    # Prosecutor General's Office variants
    'генпрокуратуры': 'Генеральная прокуратура',
    'юрий чайка': 'Генеральная прокуратура',
    'генеральная прокуратура': 'Генеральная прокуратура',
    
    # Sberbank variants
    'сбербанк онлайн': 'Сбербанк',
    'сбербанк': 'Сбербанк',
    'сбербанк киб': 'Сбербанк',
    'сбербанка россии': 'Сбербанк',
    'сбера': 'Сбербанк',
    'sberbank cib': 'Сбербанк',
    
    # First Collection Bureau variants
    'первое коллекторское бюро пкб': 'Первое коллекторское бюро (ПКБ)',
    'пкб': 'Первое коллекторское бюро (ПКБ)',
    
    # Russian Orthodox Church variants
    'рпц': 'Русская православная церковь (РПЦ)',
    'русской православной церкви': 'Русская православная церковь (РПЦ)',
    
    # State Commission for Radio Frequencies variants
    'госкомиссии по радиочастотам гкрч': 'Государственная комиссия по радиочастотам (ГКРЧ)',
    'гкрч': 'Государственная комиссия по радиочастотам (ГКРЧ)',
    
    # Khabib Nurmagomedov variants
    'хабиб нурмагомедов': 'Хабиб Нурмагомедов',
    'нурмагомедов': 'Хабиб Нурмагомедов',
    
    # Denis Manturov variants
    'денис мантуров': 'Денис Мантуров',
    'мантуров': 'Денис Мантуров',
    
    # SVR variants
    'службы внешней разведки': 'Служба внешней разведки (СВР)',
    'свр': 'Служба внешней разведки (СВР)',
    
    # PIF variants
    'public investment fund pif': 'Public Investment Fund (PIF)',
    'саудовской аравии public investment fund pif': 'Public Investment Fund (PIF)',
    
    # Yury Trutnev variants
    'трутнев': 'Юрий Трутнев',
    'юрий трутнев': 'Юрий Трутнев',
    
    # Roman Abramovich variants
    'роман абрамович': 'Роман Абрамович',
    'абрамовича': 'Роман Абрамович',
    
    # Alexey Kudrin variants
    'алексей кудрин': 'Алексей Кудрин',
    'кудрин': 'Алексей Кудрин',
    
    # FEFU variants
    'дальневосточного федерального университета': 'Дальневосточный федеральный университет (ДВФУ)',
    'двфу': 'Дальневосточный федеральный университет (ДВФУ)',
    
    # Abdel Fattah el-Sisi variants
    'сиси': 'Абдель Фаттах ас-Сиси',
    'абдель фаттаха ас-сиси': 'Абдель Фаттах ас-Сиси',
    
    # Alexey Ulyukayev variants
    'улюкаев': 'Алексей Улюкаев',
    'алексей улюкаев': 'Алексей Улюкаев',
    
    # Barack Obama variants
    'барак обама': 'Барак Обама',
    'обама': 'Барак Обама',
    'обамы': 'Барак Обама',
    'бараком обамой': 'Барак Обама',
    
    # Sherzoda Yusupova variants
    'шерзода юсупова': 'Шерзода Юсупова',
    'юсупова': 'Шерзода Юсупова',
    
    # Nicolas Maduro variants
    'николас мадуро': 'Николас Мадуро',
    'мадуро': 'Николас Мадуро',
    
    # Customs Union variants
    'таможенный союз': 'Таможенный союз',
    'таможенного союза': 'Таможенный союз',
    
    # FMBA variants
    'федерального медико-биологического агентства фмба': 'Федеральное медико-биологическое агентство (ФМБА)',
    'фмба': 'Федеральное медико-биологическое агентство (ФМБА)',
    
    # Mikhail Mishustin variants
    'михаил мишустин': 'Михаил Мишустин',
    'мишустин': 'Михаил Мишустин',
    
    # SIBUR variants
    'сибура': 'ПАО «СИБУР Холдинг»',
    'сибур': 'ПАО «СИБУР Холдинг»',
    'сибуром': 'ПАО «СИБУР Холдинг»',
    'пао сибур холдинг': 'ПАО «СИБУР Холдинг»',
    'сибур холдинга': 'ПАО «СИБУР Холдинг»',
    
    # Elon Musk variants
    'илон маск': 'Илон Маск',
    'маск': 'Илон Маск',
    'маска': 'Илон Маск',
    'илоном маском': 'Илон Маск',
    'маском': 'Илон Маск',
    
    # Russian Railways variants
    'оао «ржд»': 'ОАО «РЖД»',
    'оао ржд': 'ОАО «РЖД»',
    'ржд': 'ОАО «РЖД»',
    
    # Elvira Nabiullina variants
    'эльвира набиуллина': 'Эльвира Набиуллина',
    'набиуллина': 'Эльвира Набиуллина',
    
    # Moscow State University variants
    'мгу им мв ломоносова': 'Московский государственный университет имени М.В. Ломоносова (МГУ)',
    'мгу': 'Московский государственный университет имени М.В. Ломоносова (МГУ)',
    
    # Tatyana Golikova variants
    'татьяна голикова': 'Татьяна Голикова',
    'голикова': 'Татьяна Голикова',
    'татьяны голиковой': 'Татьяна Голикова',
    
    # WTO variants
    'всемирная торговая организация': 'Всемирная торговая организация (ВТО)',
    'вто': 'Всемирная торговая организация (ВТО)',
    
    # Rosavtodor variants
    'росавтодор': 'Росавтодор',
    'автодор': 'Росавтодор',
    'гк автодор': 'Росавтодor',
    
    # Eastern Economic Forum variants
    'вэф-2017': 'Восточный экономический форум (ВЭФ)',
    'вэф': 'Восточный экономический форум (ВЭФ)',
    
    # Alexander Gintsburg variants
    'александр гинцбург': 'Александр Гинцбург',
    'гинцбург': 'Александр Гинцбург',
    
    # Michael Calvey variants
    'майкла калви': 'Майкл Калви',
    'калви': 'Майкл Калви',
    'майкла': 'Майкл Калви',
    
    # Mail.ru Group variants
    'mailru': 'Mail.ru Group',
    'mailru group': 'Mail.ru Group',
    
    # AFK Sistema variants
    'афк «система»': 'АФК «Система»',
    'афк система': 'АФК «Система»',
    'афк': 'АФК «Система»',
    
    # RSPP variants
    'российского союза промышленников и предпринимателей': 'Российский союз промышленников и предпринимателей (РСПП)',
    'рспп': 'Российский союз промышленников и предпринимателей (РСПП)',
    
    # Gazprom variants
    'газпрома': 'ОАО «Газпром»',
    'газпромом': 'ОАО «Газпром»',
    'оао газпром': 'ОАО «Газпром»',
    
    # Gazprom Neft variants
    'газпром нефть': 'ПАО «Газпром нефть»',
    'пао «газпром нефть': 'ПАО «Газпром нефть»',
    
    # Igor Sechin variants
    'игорь сечин': 'Игорь Сечин',
    'сечин': 'Игорь Сечин',
    
    # Ministry of Finance variants
    'минфином': 'Министерство финансов',
    'минфина': 'Министерство финансов',
    'минфин': 'Министерство финансов',
    'министерства финансов': 'Министерство финансов',
    
    # Rosneft variants
    'роснефтью': 'НК «Роснефть»',
    'оао нк роснефть': 'НК «Роснефть»',
    'нк роснефть': 'НК «Роснефть»',
    'роснефти': 'НК «Роснефть»',
    
    # Igor Shuvalov variants
    'шувалов': 'Игорь Шувалов',
    'игорем шуваловым': 'Игорь Шувалов',
    'игорь шувалов': 'Игорь Шувалов',
    
    # RAO UES variants
    'российской энергетической': 'РАО «ЕЭС России»',
    'рао еэс': 'РАО «ЕЭС России»',
    'интер рао еэс': 'РАО «ЕЭС России»',
    
    # New Development Bank variants
    'нового банка развития': 'Новый банк развития',
    'новым банком развития': 'Новый банк развития',
    'банка развития': 'Новый банк развития',
    
    # ECB variants
    'европейского центрального банка': 'Европейский центральный банк (ЕЦБ)',
    'ецб': 'Европейский центральный банк (ЕЦБ)',
    
    # Suleyman Kerimov variants
    'сулеймана керимова': 'Сулейман Керимов',
    'керимова': 'Сулейман Керимов',
    
    # Maxim Oreshkin variants
    'максим орешкин': 'Максим Орешкин',
    'орешкин': 'Максим Орешкин',
    
    # Alexander Lukashenko variants
    'александр лукашенко': 'Александр Лукашенко',
    'лукашенко': 'Александр Лукашенко',
    
    # European Commission variants
    'еврокомиссии': 'Европейская комиссия',
    'европейской комиссии': 'Европейская комиссия',
    
    # Maria Zakharova variants
    'мария захарова': 'Мария Захарова',
    'захарова': 'Мария Захарова',
    
    # Oleg Deripaska variants
    'олег дерипаска': 'Олег Дерипаска',
    'дерипаска': 'Олег Дерипаска',
    
    # FSVTS variants
    'фсвтс': 'Федеральная служба по военно-техническому сотрудничеству (ФСВТС)',
    'федеральной службы по военно-техническому сотрудничеству': 'Федеральная служба по военно-техническому сотрудничеству (ФСВТС)',
    
    # VTB variants
    'втб 24': 'Банк ВТБ',
    'втб': 'Банк ВТБ',
    'банка втб': 'Банк ВТБ',
    
    # VimpelCom variants
    'вымпелком': 'ОАО «ВымпелКом»',
    'оао «вымпелком»': 'ОАО «ВымпелКом»',
    'вымпелкома': 'ОАО «ВымпелКом»',
    
    # Rosseti variants
    'россети': '«Россети»',
    'россетей': '«Россети»',
    
    # Roskomnadzor variants
    'федеральной службой по надзору в сфере связи информационных технологий и массовых коммуникаций': 'Роскомнадзор',
    'роскомнадзор': 'Роскомнадзор',
    
    # Nikolai Tokarev variants
    'николай токарев': 'Николай Токарев',
    'токарев': 'Николай Токарев',
    
    # David Cameron variants
    'кэмерон': 'Дэвид Кэмерон',
    'дэвидом кэмероном': 'Дэвид Кэмерон',
    
    # Alexander Kozlov variants
    'александра козлова': 'Александр Козлов',
    'александр козлов': 'Александр Козлов',
    
    # German Gref variants
    'герман греф': 'Герман Греф',
    'греф': 'Герман Греф',
    
    # Supreme Arbitration Court variants
    'высшего арбитражного суда': 'Высший арбитражный суд',
    'арбитражного суда': 'Высший арбитражный суд',
    
    # Maxim Reshetnikov variants
    'максим решетников': 'Максим Решетников',
    'решетников': 'Максим Решетников',
    
    # Alexey Navalny variants
    'алексея навального': 'Алексей Навальный',
    'навального': 'Алексей Навальный',
    'алексей навальный': 'Алексей Навальный',
    'навальный': 'Алексей Навальный',
    
    # Maxim Sokolov variants
    'соколов': 'Максим Соколов',
    'максим соколов': 'Максим Соколов',
    
    # Anthony Scaramucci variants
    'энтони скарамуччи': 'Энтони Скарамуччи',
    'скарамуччи': 'Энтони Скарамуччи',
    
    # Leonid Mikhelson variants
    'леонид михельсон': 'Леонид Михельсон',
    'михельсон': 'Леонид Михельсон',
    
    # Renova variants
    'ренова': '«Ренова»',
    'реновы': '«Ренова»',
    
    # Vladimir Zhirinovsky variants
    'владимир жириновский': 'Владимир Жириновский',
    'жириновский': 'Владимир Жириновский',
    
    # CPRF variants
    'коммунистической партии': 'Коммунистическая партия Российской Федерации (КПРФ)',
    'компартии': 'Коммунистическая партия Российской Федерации (КПРФ)',
    'кпрф': 'Коммунистическая партия Российской Федерации (КПРФ)',
    
    # Sergey Mironov variants
    'сергей миронов': 'Сергей Миронов',
    'миронов': 'Сергей Миронов',
    
    # Khalid al-Falih variants
    'халид аль-фалих': 'Халид аль-Фалих',
    'аль-фалих': 'Халид аль-Фалих',
    
    # FTS variants
    'фнс': 'Федеральная налоговая служба (ФНС)',
    'федеральной налоговой службы': 'Федеральная налоговая служба (ФНС)',
    
    # Nikolai Nikiforov variants
    'николай никифоров': 'Николай Никифоров',
    'никифоров': 'Николай Никифоров',
    
    # Sergey Kalugin variants
    'сергей калугин': 'Сергей Калугин',
    'калугин': 'Сергей Калугин',
    
    # Valentina Matvienko variants
    'валентина матвиенко': 'Валентина Матвиенко',
    'матвиенко': 'Валентина Матвиенко',
    
    # Valery Gergiev variants
    'валерия гергиева': 'Валерий Гергиев',
    'валерия': 'Валерий Гергиев',
    
    # Dmitry Chernyshenko variants
    'дмитрий чернышенко': 'Дмитрий Чернышенко',
    'чернышенко': 'Дмитрий Чернышенко',
    
    # Oleg Belozerov variants
    'олег белозеров': 'Олег Белозеров',
    'белозеров': 'Олег Белозеров',
    
    # Friedrich Merz variants
    'фридрих мерц': 'Фридрих Мерц',
    'мерц': 'Фридрих Мерц',
    
    # RFS variants
    'рфс': 'Российский футбольный союз (РФС)',
    'российского футбольного союза': 'Российский футбольный союз (РФС)',
    
    # Mohammed bin Zayed Al Nahyan variants
    'мухаммед бен заид аль нахайян': 'Мухаммед бен Заид Аль Нахайян',
    'мухаммедом бен сальманом аль саудом': 'Мухаммед бен Заид Аль Нахайян',
    'мухаммедом аль нахайяном': 'Мухаммед бен Заид Аль Нахайян',
    'мухаммед бен сальман': 'Мухаммед бен Заид Аль Нахайян',
    
    # G20 variants
    'группы двадцати': 'Группа двадцати (G20)',
    'большой двадцатки': 'Группа двадцати (G20)',
    
    # Northern Sea Route variants
    'северного морского пути': 'Северный морской путь (СМП)',
    'смп': 'Северный морской путь (СМП)',
    
    # USC variants
    'объединенная судостроительная корпорация оск': 'Объединенная судостроительная корпорация (ОСК)',
    'оск': 'Объединенная судостроительная корпорация (ОСК)',
    
    # Alexander Ovechkin variants
    'александра овечкина': 'Александр Овечкин',
    'овечкин': 'Александр Овечкин',
    
    # Deutsche Bank variants
    'дойче-банку': 'Deutsche Bank',
    'deutsche bank': 'Deutsche Bank',
    
    # NATO variants
    'североатлантического альянса': 'Организация Североатлантического договора (НАТО)',
    'нато': 'Организация Североатлантического договора (НАТО)',
    
    # Erik Prince variants
    'эрик принс': 'Эрик Принс',
    'принс': 'Эрик Принс',
    
    # SPIEF variants
    'пмэф-2018': 'Петербургский международный экономический форум (ПМЭФ)',
    'пмэф': 'Петербургский международный экономический форум (ПМЭФ)',
    
    # FSB variants
    'фсб': 'Федеральная служба безопасности (ФСБ)',
    'федеральной службы безопасности': 'Федеральная служба безопасности (ФСБ)',
    
    # SCO variants
    'шанхайской организации сотрудничества шос': 'Шанхайская организация сотрудничества (ШОС)',
    'шос': 'Шанхайская организация сотрудничества (ШОС)',
    
    # Anna Politkovskaya variants
    'анны политковской': 'Анна Политковская',
    
    # Harvard University variants
    'гарвардского университета': 'Гарвардский университет',
    'гарвардской школе бизнеса': 'Гарвардский университет',
    
    # Mikhail Prokhorov variants
    'михаила прохорова': 'Михаил Прохоров',
    'прохоров': 'Михаил Прохоров',
    
    # Darya Vasilevskaya variants
    'дарья василевская': 'Дарья Василевская',
    'дарья': 'Дарья Василевская',
    
    # Viktor Medvedchuk variants
    'виктор медведчук': 'Виктор Медведчук',
    'медведчук': 'Виктор Медведчук',
    
    # Andrey Belousov variants
    'андрей белоусов': 'Андрей Белоусов',
    'белоусова': 'Андрей Белоусов',
    
    # Federal Reserve variants
    'фрс': 'Федеральная резервная система (ФРС)',
    'федеральной резервной системы фрс': 'Федеральная резервная система (ФРС)',
    
    # Dmitry Rogozin variants
    'дмитрий рогозин': 'Дмитрий Рогозин',
    'рогозин': 'Дмитрий Рогозин',
    
    # MTS variants
    'мтс': 'ПАО «МТС»',
    'оао «мтс»': 'ПАО «МТС»',
    'группы мтс': 'ПАО «МТС»',
    'мтс «северо-запад»': 'ПАО «МТС»',
    'пао мтс': 'ПАО «МТС»',
    'мтс северо-запад': 'ПАО «МТС»',
    'компания мтс': 'ПАО «МТС»',
    
    # Ministry of Culture variants
    'минкультуры': 'Министерство культуры',
    'министерства культуры': 'Министерство культуры',
    'минкульт': 'Министерство культуры',
    
    # Erginskoe variants
    'эргинское': 'Эргинское',
    'эргинского': 'Эргинское',
    
    # Alexander Petrov variants
    'александр петров': 'Александр Петров',
    'петров': 'Александр Петров',
    
    # Mike Waltz variants
    'майк уолтц': 'Майк Уолтц',
    'уолтц': 'Майк Уолтц',
    
    # Alexander Shokhin variants
    'александр шохин': 'Александр Шохин',
    'шохин': 'Александр Шохин',
    
    # Robert Mueller variants
    'мюллера': 'Роберт Мюллер',
    'роберта мюллера': 'Роберт Мюллер',
    
    # Yandex.Zen variants
    'яндексдзен': 'Яндекс.Дзен',
    'дзен': 'Яндекс.Дзен',
    
    # Benjamin Netanyahu variants
    'биньямина нетаньяху': 'Биньямин Нетаньяху',
    
    # Council of Europe variants
    'совета европы': 'Совет Европы',
    'европейского совета': 'Совет Европы',
    
    # Basic Element variants
    'базовый элемент': '«Базовый элемент»',
    'базового элемента': '«Базовый элемент»',
    
    # Recep Tayyip Erdogan variants
    'реджепа тайипа эрдогана': 'Реджеп Тайип Эрдоган',
    'эрдоган': 'Реджеп Тайип Эрдоган',
    
    # Peter Szijjarto variants
    'петер сийярто': 'Петер Сийярто',
    'сийярто': 'Петер Сийярто',
    
    # State Duma Committee variants
    'комитета государственной думы': 'Комитет Государственной Думы',
    'комитета госдумы': 'Комитет Государственной Думы',
    
    # Andrey Kostin variants
    'андрей костин': 'Андрей Костин',
    'костин': 'Андрей Костин',
    
    # Oxford University variants
    'оксфордским университетом': 'Оксфордский университет',
    'оксфордского университета': 'Оксфордский университет',
    
    # State Duma variants
    'государственной думе': 'Государственная Дума',
    'мосгордумы': 'Государственная Дума',
    
    # Keir Starmer variants
    'кир стармер': 'Кир Стармер',
    'стармер': 'Кир Стармер',
    
    # UFC variants
    'ufc russia': 'Абсолютный бойцовский чемпионат (UFC)',
    'абсолютного бойцовского чемпионата ufc': 'Абсолютный бойцовский чемпионат (UFC)',
    
    # IMF variants
    'мвф': 'Международный валютный фонд (МВФ)',
    'международный валютный фонд': 'Международный валютный фонд (МВФ)',
    'международного валютного фонда мвф': 'Международный валютный фонд (МВФ)',
    
    # Moscow City Court variants
    'мосгорсуд': 'Мосгорсуд',
    
    # Ksenia Yudaeva variants
    'ксения юдаева': 'Ксения Юдаева',
    'ксения': 'Ксения Юдаева',
    
    # LUKOIL variants
    'лукойл': 'ОАО «ЛУКОЙЛ»',
    'лукойла': 'ОАО «ЛУКОЙЛ»',
    'оао лукойл': 'ОАО «ЛУКОЙЛ»',
    
    # Anatoly Chubais variants
    'анатолий чубайс': 'Анатолий Чубайс',
    'чубайс': 'Анатолий Чубайс',
    
    # SPbSU variants
    'санкт-петербургского государственного университета': 'Санкт-Петербургский государственный университет (СПбГУ)',
    'спбгу': 'Санкт-Петербургский государственный университет (СПбГУ)',
    
    # Rosagrolizing variants
    'росагролизинга': 'Росагролизинг',
    
    # GRU variants
    'главного управления': 'Главное разведывательное управление (ГРУ)',
    'гру': 'Главное разведывательное управление (ГРУ)',
    
    # Sergey Chemezov variants
    'сергей чемезов': 'Сергей Чемезов',
    'чемезов': 'Сергей Чемезов',
    
    # Federal Assembly variants
    'федерального собрания': 'Федеральное собрание',
    'федеральному собранию': 'Федеральное собрание',
    'законодательного собрания': 'Федеральное собрание',
    
    # J.D. Vance variants
    'джей ди вэнс': 'Джей Ди Вэнс',
    'вэнс': 'Джей Ди Вэнс',
    
    # Narendra Modi variants
    'нарендра моди': 'Нарендра Моди',
    'моди': 'Нарендра Моди',
    
    # Viktor Yanukovych variants
    'виктора януковича': 'Виктор Янукович',
    'януковича': 'Виктор Янукович',
    
    # Konstantin Malofeev variants
    'константина малофеева': 'Константин Малофеев',
    
    # Sebastian Kurz variants
    'себастьян курц': 'Себастьян Курц',
    'курц': 'Себастьян Курц',
    
    # Supreme Eurasian Economic Council variants
    'экономического совета': 'Высший Евразийский экономический совет',
    'высшего евразийского экономического совета': 'Высший Евразийский экономический совет',
    
    # Elena Shmeleva variants
    'елена шмелева': 'Елена Шмелева',
    'елена': 'Елена Шмелева',
    
    # Keith Kellogg variants
    'кит келлог': 'Кит Келлог',
    'келлог': 'Кит Келлог',
    
    # Rusal variants
    'русала': '«Русал»',
    'русал': '«Русал»',
    
    # Rostec variants
    'ростехнологий': '«Ростех»',
    'ростех': '«Ростех»',
    
    # Denis Logunov variants
    'денис логунов': 'Денис Логунов',
    'логунов': 'Денис Логунов',
    
    # MFC variants
    'мфц': 'Многофункциональный центр (МФЦ)',
    'госуслуги': 'Многофункциональный центр (МФЦ)',
    
    # FCS variants
    'фтс': 'Федеральная таможенная служба (ФТС)',
    'федеральной таможенной службы': 'Федеральная таможенная служба (ФТС)',
    
    # Ilya Klebanov variants
    'илья клебанов': 'Илья Клебанов',
    'илья': 'Илья Клебанов',
    
    # European Union variants
    'европейского союза': 'Европейский союз',
    'европейский союз': 'Европейский союз',
    'европейском союзе': 'Европейский союз',
    
    # Eurasian Economic Union variants
    'евразийским экономическим союзом': 'Евразийский экономический союз',
    'евразийского экономического союза': 'Евразийский экономический союз',
    
    # Artem Avetisyan variants
    'артем аветисян': 'Артем Аветисян',
    'аветисян': 'Артем Аветисян',
    
    # Shinzo Abe variants
    'синдзо абэ': 'Синдзо Абэ',
    'абэ': 'Синдзо Абэ',
    
    # Pension Fund variants
    'пенсионный фонд': 'Пенсионный фонд России (ПФР)',
    'пфр': 'Пенсионный фонд России (ПФР)',
    'пенсионного фонда': 'Пенсионный фонд России (ПФР)',
    
    # Bolshoi Theatre variants
    'габт': 'Государственный академический Большой театр (ГАБТ)',
    'большого театра': 'Государственный академический Большой театр (ГАБТ)',
    
    # Vladimir Yevtushenkov variants
    'владимир евтушенков': 'Владимир Евтушенков',
    'евтушенков': 'Владимир Евтушенков',
    
    # Sergey Naryshkin variants
    'сергей нарышкин': 'Сергей Нарышкин',
    'нарышкин': 'Сергей Нарышкин',
}

# Function to normalize entity names in a case-insensitive way
def normalize_entity_name(entity):
    entity_stripped = str(entity).strip()
    key = entity_stripped.lower()
    return entity_mapping.get(key, entity_stripped)

# Apply the normalization
print("Applying entity name normalization...")
df['Entity'] = df['Entity'].apply(normalize_entity_name)

# Save the changes to the same file
df.to_excel('unique_entities.xlsx', index=False)

print(f"\nNormalization complete!")
print(f"Unique entities after normalization: {df['Entity'].nunique():,}")
print("Results saved to ner_entity_dataset_superclean.csv")

# Show some examples of the most frequent entities after normalization
print(f"\nTop 10 entities after normalization:")
top_entities = df.groupby('Entity')['Occurrences'].first().sort_values(ascending=False).head(10)
for entity, count in top_entities.items():
    print(f"  {entity}: {count:,}")
